(function(a){function bB(a){function c(c,d,e){if(e||!(c in b))b[c]=d;a=b}var b={};bx.type(a)==g&&Z(b,a),this.all=function(){return Z(b)},this.add=function(a){switch(typeof a){case h:c(a,arguments[1],i);break;case g:for(var b in a)c(b,a[b],i)}return this},this.get=function(a){return b[a]},this.replace=function(a){switch(typeof a){case h:c(a,arguments[1],k);break;case g:for(var b in a)c(b,a[b],k)}return this}}function bA(a){this.compiled||bz(this);return this._parse(a)}function bz(a){a.compiled||(a.compiled=k,a._parse=bn(a,a.__tpl));return a}function by(a){a.id||(a.id=_(V,++A));return a.id}function bx(){var a=o.call(arguments),b=bx.type(a[a.length-1])==g?a.pop():bx.type(a[0])==g?a.shift():null;this.filters=b||{},!b||["compiled","debug","fallback","id"].forEach(function(a){if(a in b)this[a]=b[a],delete b[a];else return},this),this.__tpl=a.join(""),U[by(this)]=this,this.compiled&&(this.compiled=i,bz(this))}function bw(a){return _("{0}.push( {1} );",x.output,a.replace(/[\n\r]/gm,"\\n"))}function bv(a,b){b=bl(b);var c=a.currentIterKeys||[];return Y(b,".call(")||M.test(b)||p.startsWith(b,'"')&&p.endsWith(b,'"')||p.startsWith(b,"'")&&p.endsWith(b,"'")||!isNaN(b)?b:p.startsWith(b,"$_.")||p.startsWith(b,"iter.")||c.length&&bu(c,b)||b in m?b.replace(N,O):_('$C.get( "{0}" )',b)}function bu(a,b){return a.length?a.some(function(a){return a.some(bt,b)}):0}function bt(a){return this==a||p.startsWith(this,a+".")}function bs(a){switch(bx.type(a)){case h:case f:case"boolean":return String(a);case"date":return a.toDateString();case b:return bc(a,bs).join(", ");case g:if(s in a)return bs(a.dict);var c=a.toString();if(c!="[object Object]")return c;return bc(D(a),bs).join(", ");case e:return a.textContent;case d:return bc(o.call(a),function(a){return a.textContent}).join(", ")}return""}function br(a){var b=a.replace(R,T);b=b.split(S),b=b.reduce(bi,[]);return b}function bq(a){return p[a]?x.assert:r[a]?x.util:x.format}function bp(a,b){b=bl(b);return Y(b,"|")||Y(b,u)?(" "+b+u).replace(P,function(b){if(p.blank(b)||b==u)return"";var c=bl(b).split("|");return bj(a,c)}):bv(a,b)}function bo(a,b,c){var d;if(d=bx.Tags.get(b)){b=c.shift();return d.emit(B,a,b,c)}return bw(_('"{0}"',b.replace(F,"\\$1")))}function bn(a,b){a.currentIterKeys=[];var c=bm(a,bk(a,br(b)));delete a.currentIterKeys;return c}function bm(b,c){b.debug&&a.console&&(console.info(b.id),console.log(c));var d=new Function(x.format,x.assert,x.util,x.dict,c);return X(d,b,Z(b.filters,bx.Filters.all(),k),p,r)}function bl(a){return a.replace(H,"").replace(J,"\n").replace(Q," ").trim()}function bk(a,b){var c=[z],d;while(d=b.shift())c.push(bo(a,d,b));c.push(y);return c.join("\r\n")}function bj(a,b){var c='{0}["{1}"].call( this, {2}{3}, {4} )';return b.reduce(function(b,d,e,f){if(e==0)return bv(a,d);d=d.split(":");var g="",i=d.shift();typeof d[0]==h&&(g=", "+d[0].split(",").map(function(a){return bv(this,a)},a).join(", "));return _(c,bq(i),i,bv(a,b),g,x.dict)},"")}function bi(a,b){!bd(b)||a.push(b);return a}function bh(a){this.__data=bx.type(a)==b?a:[]}function bg(a,b,c,d){if(!a)return this;c=c===l?-1:c-2,d=d===l?0:d,this.index=c,this.index1=c+1,this.items=p.iterable(a)?a:j,this.type=bx.type(a),this.type==g&&(this.items=D(a),this.keys=C(a),this.firstKey=this.keys[0],this.lastKey=this.keys[this.keys.length-1]),this.items&&(this.count=d?d:this.items.length,this.first=this.items[0],this.last=this.items[this.count-1]),b.items!=l&&(this.parent=b)}function bf(b,c){this[s]={},this[t]=[a],c!==l&&(this.hasFallback=k,this.fallback=c),p.exists(b)&&this.push(b)}function be(a){if(a===l)return l;var b=o.call(arguments,1),c;if(b.length==1){if(b[0]===l)return l;if(b[0].indexOf(".")<0)return a[b[0]];b=b[0].split(".")}while(c=b.shift())if(c in a)a=a[c];else return l;return a}function bd(a){switch(bx.type(a)){case i:return i;case f:return!isNaN(a);case h:return a!="";case b:return!!a.length;case g:for(var c in a)if(c)return k}return i}function bc(a,b,c){c||(c=a);return a.reduce(function(d,e,f){var g=b.call(c,e,f,a);p.blank(g)||d.push(g);return d},[])}function bb(a,b,c){return String(a).replace(c||n,function(a,c){return b[c]||""})}function ba(a){return U[a]||j}function _(a){return bb(a,o.call(arguments,1))}function $(a){return String(a).replace(v,w)}function Z(a,b,c){c=c===k,b||(b=a,a={});for(var d in b)if(!c||!(d in a))a[d]=b[d];return a}function Y(a,b){return bx.type(a.indexOf)==c?a.indexOf(b)>-1:b in a}function X(a,b){var c=o.call(arguments,2);return function(){return a.apply(b||this,c.concat(o.call(arguments)))}}function W(a){if(a===l||a===j)return i;var b={}.toString.call(a).substring(8).toLowerCase().replace(L,"");return E.test(b)?d:G.test(b)?e:b}var b="array",c="function",d="htmlcollection",e="htmlelement",f="number",g="object",h="string",i=!1,j=null,k=!0,l,m={$_:k,__ASSERT__:k,__CONTEXT__:k,__FORMAT__:k,__OUTPUT__:k,__UTIL__:k,document:k,"false":k,"instanceof":k,"null":k,"true":k,"typeof":k,"undefined":k,window:k},n=/\{([^\}\s]+)\}/g,o=[].slice,p={blank:function(a){return!bd(a)||a.trim()==""||!K.test(a)},contains:Y,endsWith:function(a,b){a=String(a);var c=a.length-b.length;return c>=0&&a.lastIndexOf(b)==c},empty:function(a){return!bd(a)},equals:function(a,b){return a==b},exists:function(a){return typeof a==f?!isNaN(a):a!==l&&a!==j},is:function(a,b){return a===b},isEven:function(a){return!(parseInt(a,10)&1)},isOdd:function(a){return!(parseInt(a,10)&1)},isTPL:function(a){return!!bx.get(a)},iterable:function(a){return I.test(bx.type(a))},notEmpty:bd,startsWith:function(a,b){return String(a).indexOf(b)===0}},q={},r={context:function(a,b){return new bf(a,b)},output:function(a){return new bh(a)},iter:function(a,b,c,d){return new bg(a,b,c,d)},parse:function(a,b){var c=ba(String(b).trim());return c?c.parse(a,this.filters):this.fallback},stop:function(a){a.stop()}},s="__tpl_cs_cached_keys",t="__tpl_cs_stack",u="<~>",v=/([\u0021\u0028\u0029\u002a\u002b\u002e\u003a\u003d\u003f\u005b\u005d\u005e\u007b\u007c\u007d\/\\])/g,w="\\$1",x={assert:"__ASSERT__",dict:"__CONTEXT__",format:"__FORMAT__",output:"__OUTPUT__",util:"__UTIL__"},y=_('$C.destroy(); return {0}.join( "" );\n ',x.output),z=_("var $C = {0}.context( {1}, this.fallback ), $_ = $C.current(), iter = {0}.iter(), {2} = {0}.output(), UNDEF;",x.util,x.dict,x.output),A=999,B,C=Object.keys||function(a){var b,c=[];for(b in a)c.push(b);return c},D=Object.values||function(a){var b,c=[];for(b in a)c.push(a[b]);return c},E=/htmcollection|nodelist/,F=/(['"])/g,G=/^html\w+?element$/,H=new RegExp(u,"gm"),I=/array|htmlcollection|object|arguments|nodelist/,J=/[\r\n]+/g,K=/\S/,L=/\]$/,M=/[\(\)\[\]\{\}\?\*\+\/<>%&=!-]/,N=/\.(\d+)(\.?)/g,O="['$1']$2",P=new RegExp("\\s*([^\\|]+(?:\\|[^\\|]+?)){0,}"+u,"g"),Q=/\s+/g,R,S="<__SPLIT__TEMPLATE__HERE__>",T=["","$1","$2",""].join(S),U={},V="tpl-anon-{0}";bf.prototype={current:function(){return this[t][0]},destroy:function(){this.destroyed=k,delete this[s],delete this[t];return this},get:function(a){var b=this[s],c=-1,d,e,f=this[t],g=f.length,h;while(++c<g){e=f[c],d=e.dict;if(a in b&&d===b[a].o)return b[a].v;if((h=be(d,a))!==l){b[a]={o:d,v:h},e[s].push(a);return b[a].v}}return this.hasFallback?this.fallback:l},pop:function(){return this[t].shift()},push:function(a){var b={dict:a};b[s]=[],this[t].unshift(b);return this}},bg.prototype={hasNext:function(){if(this.stopped||isNaN(this.index)||!this.items)return i;if(++this.index>=this.count)return i;this.index>=this.count-1&&(this.isLast=k),this.current=this.items[this.index],this.previous=this.items[this.index-1]||l,this.next=this.items[++this.index1]||l,this.type==g&&(this.key=this.keys[this.index],this.previousKey=this.keys[this.index-1]||l,this.nextKey=this.keys[this.index1]||l);return this},stop:function(){this.stopped=k;return this}},bh.prototype={join:function(){return this.__data.join("")},push:function(a){this.__data.push(bs(a));return this}},B={assembleparts:bk,clean:bl,compiletpl:bm,createtpl:bn,emittag:bo,fnvar:x,formatstatement:bp,get:bv,util:r,wrap:bw},bx.prototype={compiled:i,debug:i,fallback:"",parse:bA},Z(bx,{copy:Z,escapeRE:$,fnBind:X,format:_,get:ba,gsub:bb,objectKeys:C,objectValues:D,tostr:bs,type:W}),bx.Assertions=new bB(p),bx.Filters=new bB(q),bx.Statements=new bB,bx.Tags=new function(){function h(a){return c[a]}function g(a,b){new d(a),b!==k&&f();return this}function f(){var a=[],b=[],d;for(d in c)a.push($(c[d].end.substring(0,1))),b.push($(c[d].start.substring(1)));return R=new RegExp("(\\{["+b.join("")+"])\\s*(.+?)\\s*(["+a.join("")+"]\\})","gm")}function e(a){if(!(a in this))throw new TypeError(_("A Templ8 Tag requires an {0}",b[a]))}function d(b){a.forEach(e,b),Z(this,b),c[this.start]=this}var a="emit end start".split(" "),b={emit:"emit function",end:"end tag definition",start:"start tag definition"},c={};this.all=function(){return Z(c)},this.compileRegExp=f,this.create=g,this.get=h};var bC=[{start:"{{",end:"}}",emit:function(a,b,c,d){if(c=="")throw new SyntaxError("Templ8 missing key in value declaration.");var e,f,g,h;bJ.test(c)&&(e=Y(c,"|")?(c.match(bI)||bD).filter(bd):c.match(bI));if(!e||e.length<=2)return a.wrap(a.formatstatement(b,c));e.shift(),h=a.formatstatement(b,e.shift()),g=bE(e.shift().toLowerCase()),f=e.join(" ");if(!g||!f)throw new SyntaxError("Templ8 missing tag or statement in one liner value declaration.");return g(a,b,f,d)+a.wrap(h)+bE("endif")}},{start:"{%",end:"%}",emit:function(a,b,d,e){if(d=="")throw new SyntaxError("Templ8 missing key in statement declaration.");var f,g,i;if(!(i=bE(d.toLowerCase()))){f=d.split(" "),i=bE(f.shift().toLowerCase());if(f.length==0&&typeof i==h)return i;g=f.join(" ");if(!i||!g)throw new SyntaxError("Templ8 missing tag or statement in statement declaration.")}if(!i)throw new SyntaxError(_("Templ8 tag: {0} does not exist.",i));return typeof i==c?i(a,b,g,e):i}},{start:"{[",end:"]}",emit:function(a,b,c,d){c=c.replace(bF,"$1").split("for each");var e,f,g,h,i=a.clean(c.shift()),j=a.clean(c.pop()).match(bG);c=[],j.shift(),h=j.shift(),g=j.shift(),j.length>=2&&(f=j.shift(),e=j.shift()),c.push(bE("for")(a,b,(bd(h)?h.match(bH,"$1").join(",")+" in ":"")+g,d)),e&&c.push(bE(f||"if")(a,b,e,d)),c.push(a.wrap(i.split(" ").map(function(c){return a.formatstatement(b,c)}).join(" "))),e&&c.push(bE("endif")),c.push(bE("endfor")(a,b));return c.join("")}},{start:"{:",end:":}",emit:function(a,b,c){return a.formatstatement(b,c)+";"}},{start:"{#",end:"#}",emit:function(a,b,c){return["\n/*",c,"*/\n"].join(" ")}}],bD=[],bE=bx.Statements.get,bF=/\s*(,)\s*/g,bG=/^\(\s*(.*?)(?:\bin\b){0,1}(.*?)\s*\)\s*(if|unless){0,1}\s*(.*)$/i,bH=/(\w+)/g,bI=/^(.*?)\s+(if|unless)\s+(.*)|$/i,bJ=/\s+(if|unless)\s+/i;bC.forEach(function(a){bx.Tags.create(a,k)}),bx.Tags.compileRegExp(),function(){function d(a,b,c){return c.split(" ").map(function(c){return b(a,c)}).join(" ")}var a={"for":function(a,d,e){var f,g,h,i=a.clean(e).match(b),k,m=[],n="UNDEF",o=a.fnvar;i===j?g=e:(i.shift(),f=i.pop()||l,k=i.pop()||l,g=i.pop()||i.pop(),h=(i.pop()||"").match(c)),g=a.formatstatement(d,g),m.push(_(["\n\rif ( {0}.iterable( {1} ) ) iter = {2}.iter( {1}, iter, {3}, {4} );","while ( iter.hasNext() ) {","$_ = iter.current;","$C.push( iter.current );\n\r"].join("\n\r"),o.assert,g,o.util,k||n,f||n)),h&&h.length>0&&(d.currentIterKeys.unshift(h),h.length<2?m.push(_("var {0} = iter.current;\n\r",h[0])):h.length>=2&&m.push(_("var {0} = iter.key || iter.index, {1} = iter.current;\n\r",h[0],h[1])));return m.join("")},forempty:"\n\r}\n\rif ( iter.count <= 0 || !iter.items )\n\r{\n\r",endfor:function(a,b){b.currentIterKeys.shift();return _(["\n\r$C.pop();","}","if ( $C.current() === iter.current ) { $C.pop(); }","iter = iter.parent || {0}.iter();","$_ = iter.current || $C.current();\n\r"].join("\n\r"),a.fnvar.util)},"if":function(a,b,c){return _("if ( {0} ) { ",d(b,a.formatstatement,c))},elseif:function(a,b,c){return _(" } else if ( {0} ) { ",d(b,a.formatstatement,c))},"else":" } else { ",endif:" }",sub:function(a,b,c,d){var e="endsub",f,g=c.trim(),h,i;f=d.indexOf([e,g].join(" ")),f>-1||(f=d.indexOf(e)),h=d.splice(0,f+1),h.splice(h.length-2,h.length),g=_("{0}.{1}",b.id,g),i=new bx("",bx.copy({debug:b.debug,fallback:b.fallback,id:g},b.filters)),i.currentIterKeys=[],i.__tpl=h.join(""),i._parse=a.compiletpl(i,a.assembleparts(i,h)),delete i.currentIterKeys,i.compiled=k;return""},unless:function(a,b,c){return _("if ( !( {0} ) ) { ",d(b,a.formatstatement,c))}},b=/^(\[[^,]+,\s*[^\]]+\]|[^\s]+)(?:\s+in\s+([^\s\[]+)){0,1}\s*(?:\[?(\d+)\.+(\d*)]*\]?){0,1}/i,c=/(\w+)/g;bx.Statements.add(a),bx.Statements.add("elsif",a.elseif)}();var bK={capitalize:function(a){a=bx.tostr(a);return a.charAt(0).toUpperCase()+a.substring(1).toLowerCase()},crop:function(a,b){a=bx.tostr(a),b=parseInt(b,10)||50;return a.length>b?a.substring(0,b/2)+"..."+a.substring(a.length-b/2):a},def:function(a,b){return p.blank(a)?b:a},first:function(a){switch(bx.type(a)){case b:return a[0];case h:return a.charAt(0)}},last:function(a){switch(bx.type(a)){case b:return a[a.length-1];case h:return a.charAt(a.length-1)}},lowercase:function(a){return bx.tostr(a).toLowerCase()},prefix:function(a,b){return b+a},suffix:function(a,b){return a+b},truncate:function(a,b){a=bx.tostr(a),b=parseInt(b,10)||50;return a.length>b?a.substring(0,b)+"...":a},uppercase:function(a){return bx.tostr(a).toUpperCase()}};bx.Filters.add(bK);var bL=Array.prototype,bM=String.prototype,bN={every:function(a,b){b||(b=this);var c=-1,d=this.length;while(++c<d)if(!a.call(b,this[c],c,this))return i;return k},forEach:function(a,b){b||(b=this),this.reduce(function(c,d,e,f){a.call(b,d,e,f);return c},this);return this},map:function(a,b){return this.reduce(function(c,d,e,f){c.push(a.call(b,d,e,f));return c},[],b)},reduce:function(a,b){ctx||(ctx=this);var c=-1,d=this.length;while(++c<d)b=a.call(ctx,b,this[c],c,this);return b},some:function(a,b){b||(b=this);var c=-1,d=this.length;while(++c<d)if(a.call(b,this[c],c,this))return k;return i}},bO={trim:function(a){return String(a).replace(bS,"$1").replace(bT,"$1")}},bP,bQ={}.toString,bR=/global|window/,bS=/^[\n\r\t\s]*(\S.*?)/m,bT=/(.*?\S)[\n\r\t\s]*$/m;for(bP in bN)bP in bL||(bL[bP]=bN[bP]);for(bP in bO)bP in bM||(bM[bP]=bO[bP]);bx.type=function(b){if(b===l||b===j)return i;var c=bQ.call(b).split(" ")[1].toLowerCase();c=c.substring(0,c.length-1);switch(c){case"object":if(window.attachEvent){if(b.nodeName&&b.nodeType==1)return e;if(!isNaN(b.length)&&typeof b.item=="function")return HTMLCOL;if(b===a.document)return"htmldocument";if(b===a)return"window"}return c;case"nodelist":return HTMLCOL;default:if(c.indexOf("html")>-1)return c.indexOf("htmldocument")>-1?"htmldocument":bR.test(c)?"window":HTMLEL}return c},window.Templ8=bx})(window)